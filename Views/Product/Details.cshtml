@model AutoServiceMVC.Models.Product

@{
	ViewData["Title"] = "Details";
	var comments = Model.ProductFeedbacks;
}

<section class="ftco-section">
	<div class="container mt-5">
		<div class="row justify-content-center mb-5 pb-3">
			<div class="col-md-7 heading-section ftco-animate text-center">
				<span class="subheading">Product</span>
				<h2 class="mb-4">View Detail</h2>
			</div>
		</div>
		<div class="row">
			<div class="col-lg-6 mb-5 ftco-animate">
				<img src="@Model.ProductImage" class="img-fluid" alt="@Model.ProductName" width="100%">
			</div>
			<div class="col-lg-6 product-details pl-md-5 ftco-animate">
				<h3>@Model.ProductName</h3>
				<div class="star-rating">
					<div class="back-stars">
						<span class="star" aria-hidden="true"></span>
						<span class="star" aria-hidden="true"></span>
						<span class="star" aria-hidden="true"></span>
						<span class="star" aria-hidden="true"></span>
						<span class="star" aria-hidden="true"></span>

						<div class="front-stars" style="width: @(Convert.ToInt32(Model.ProductRating/5*100))%">
							<span class="star" aria-hidden="true"></span>
							<span class="star" aria-hidden="true"></span>
							<span class="star" aria-hidden="true"></span>
							<span class="star" aria-hidden="true"></span>
							<span class="star" aria-hidden="true"></span>
						</div>
					</div>
				</div>
				<p class="price"><span>@Model.Price.ToString("N0") ₫</span></p>
				<p>@Model.ProductDescription</p>
				<div class="row mt-4">
					<div class="input-group col-md-6 d-flex mb-3">
						<span class="input-group-btn mr-2">
							<button id="minus-button" type="button" class="quantity-left-minus btn" data-type="minus" data-field="">
								<i class="icon-minus"></i>
							</button>
						</span>
						<input type="text" id="quantity" name="quantity" disabled class="form-control input-number" value="1" min="1" max="100">
						<span class="input-group-btn ml-2">
							<button id="plus-button" type="button" class="quantity-right-plus btn" data-type="plus" data-field="">
								<i class="icon-plus"></i>
							</button>
						</span>
					</div>
					<div class="col-md-6">
						<p><a id="addtocartButton" href="#" class="btn btn-primary py-3 px-5">Add to Cart</a></p>
					</div>
				</div>
			</div>
		</div>
	</div>
</section>

<section class="ftco-section contact-section">
	<div class="container">
		<div class="row justify-content-center mb-5">
			<div class="col-md-7 heading-section text-center ftco-animate">
				<span class="subheading">Feedback</span>
				<h2 class="mb-4">From Coffeer</h2>
				@if (comments.Count == 0)
				{
					<p>Add product, buy and write the first feedback.</p>
				}
			</div>
		</div>

		@if (comments.Count > 0)
		{
			<div class="row block-9">
				<div class="col-md-2"></div>
				<div class="col-md-8">
					<ul class="comment-list">
						@foreach (var item in comments)
						{
							<li class="comment">
								<div class="comment-body">
									<h3>
										@item.User.FullName
										<div class="star-rating" style="justify-content: left;">
											<div class="back-stars">
												<span class="star" aria-hidden="true"></span>
												<span class="star" aria-hidden="true"></span>
												<span class="star" aria-hidden="true"></span>
												<span class="star" aria-hidden="true"></span>
												<span class="star" aria-hidden="true"></span>

												<div class="front-stars" style="width: @(Convert.ToInt32(Model.ProductRating/5*100))%">
													<span class="star" aria-hidden="true"></span>
													<span class="star" aria-hidden="true"></span>
													<span class="star" aria-hidden="true"></span>
													<span class="star" aria-hidden="true"></span>
													<span class="star" aria-hidden="true"></span>
												</div>
											</div>
										</div>
									</h3>
									<div class="meta">@item.CreatedAt</div>
									<p>@item.Comment</p>
									@if (item.Image != null)
									{
										<img src="@item.Image" width="100%" />
									}
								</div>
							</li>
						}
					</ul>
				</div>
			</div>
		}
	</div>
</section>

@await Component.InvokeAsync("BestSellerComponent")

@section Scripts {
	<script>
		var input = document.getElementById("quantity");
		var plus = document.getElementById("plus-button");
		var minus = document.getElementById("minus-button");
		var addButton = document.getElementById("addtocartButton");

		console.log(plus)
		console.log(minus)

		plus.addEventListener("click", function() {
			let quantity = input.value;
			input.value = ++quantity;
		})

		minus.addEventListener("click", function() {
			let quantity = input.value;
			if (quantity > 1) input.value = --quantity;
		})

		addButton.addEventListener("click", e => {
			e.preventDefault();

			AddItemToCart("@Model.ProductId", "@Model.ProductName", "@Model.Price", "@Model.ProductImage", input.value);
		});
	</script>
}