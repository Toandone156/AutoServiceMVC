@using System.Security.Claims

@{
    var fullName = User.FindFirstValue(ClaimTypes.Name);
    var role = User.FindFirstValue(ClaimTypes.Role);
    var message = TempData["Message"];
}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>@ViewData["Title"] - AutoServiceMVC</title>
    <link rel="stylesheet"
          href="https://fonts.googleapis.com/css?family=Roboto:400,700" />
    <link rel="stylesheet" href="~/css/admin/fontawesome.min.css" />
    <link rel="stylesheet" href="~/lib/bootstrap/dist/css/bootstrap.min.css" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.3.1/dist/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">    
    <link rel="stylesheet" href="~/css/admin/admin.css">
</head>
<body id="reportsPage">
    <nav class="navbar navbar-expand-xl">
        <div class="container h-100">
            <a asp-area="Admin" asp-controller="Home" asp-action="Index"
                class="navbar-brand">
                <h1 class="tm-site-title mb-0">AutoService</h1>
            </a>
            <button class="navbar-toggler ml-auto mr-0" type="button" data-bs-toggle="collapse" data-bs-target=".navbar-collapse" aria-controls="navbarSupportedContent" 
            aria-expanded="false" aria-label="Toggle navigation">
                <i class="fas fa-bars tm-nav-icon"></i>
            </button>

            <div class="collapse navbar-collapse">
                <ul class="navbar-nav mx-auto h-100">
                    <li class="nav-item">
                        <a class="nav-link" 
                        asp-area="Admin" asp-controller="Home" asp-action="Index">
                            <i class="fas fa-tachometer-alt"></i>
                            Home
                        </a>
                    </li>

                    <li class="nav-item">
                        <a class="nav-link" 
                        asp-area="Admin" asp-controller="Product" asp-action="Index">
                            <i class="fas fa-shopping-cart"></i>
                            Products
                        </a>
                    </li>

                    <li class="nav-item">
                        <a class="nav-link"
                           asp-area="Admin" asp-controller="Coupon" asp-action="Index">
                            <i class="fa fa-file-invoice-dollar"></i> Coupons
                        </a>
                    </li>

                    <li class="nav-item">
                        <a class="nav-link"
                           asp-area="Admin" asp-controller="Bill" asp-action="Index">
                            <i class="fas fa-list"></i> Orders
                        </a>
                    </li>

                    <li class="nav-item">
                        <a class="nav-link"
                           asp-area="Admin" asp-controller="Feedback" asp-action="Index">
                            <i class="fas fa-comment"></i> Feedbacks
                        </a>
                    </li>

                    <li class="nav-item">
                        <a class="nav-link"
                           asp-area="Admin" asp-controller="Order" asp-action="Index">
                            <i class="fas fa-shopping-cart"></i> Menu
                        </a>
                    </li>

                    @*For admin*@

                    @if(role == "Admin")
                    {
                        <li class="nav-item dropdown">
                            <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown"
                               aria-haspopup="true" aria-expanded="false">
                                <i class="fas fa-cog"></i>
                                <span>
                                    Admin <i class="fas fa-angle-down"></i>
                                </span>
                            </a>
                            <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                                <a class="nav-link"
                                   asp-area="Admin" asp-controller="Category" asp-action="Index">
                                    <i class="fas fa-list"></i> Categories
                                </a>
                                <a class="nav-link"
                                   asp-area="Admin" asp-controller="Table" asp-action="Index">
                                    <i class="fas fa-table"></i> Tables
                                </a>
                                <a class="nav-link"
                                   asp-area="Admin" asp-controller="Employee" asp-action="Index">
                                    <i class="fas fa-users"></i> Employees
                                </a>
                                <a class="nav-link"
                                   asp-area="Admin" asp-controller="User" asp-action="Index">
                                    <i class="far fa-user"></i> Users
                                </a>
                            </div>
                        </li>
                    }

                    </ul>
                    <ul class="navbar-nav">
                        <li class="nav-item">
                            <a class="nav-link d-block" asp-controller="Auth" asp-action="Logout">
                                @fullName, <b>Logout</b>
                            </a>
                        </li>
                    </ul>
            </div>
        </div>

    </nav>
    
    <div class="container mt-5" style="min-height: 73vh">
        
        @RenderBody()
    </div>

    <footer class="tm-footer row tm-mt-small">
        <!-- This is popup message -->
        @if (message is not null)
        {
            <div class="my-popup position-absolute w-auto justify-content-end top-0 end-0 pe-4 pt-2" style="z-index: 11">
                <div id="liveToast" class="rounded-3 d-inline-flex bg-light row shadow-sm" role="alert" aria-live="assertive" aria-atomic="true" style="width:350px">
                    <div class="border-5 rounded-start border-primary border-start col-2 ps-4 pe-2 d-flex align-items-center justify-content-center">
                        <div class="p-1 mt-4 mb-4 rounded-circle d-inline-flex"
                             style="background-color: blue; color: aliceblue;">
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-check" width="24"
                                 height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none"
                                 stroke-linecap="round" stroke-linejoin="round">
                                <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                                <path d="M5 12l5 5l10 -10"></path>
                            </svg>
                        </div>
                    </div>
                    <div class="col d-flex align-items-center">
                        <div class="body">
                            <h6 class="card-title pb-1">Success</h6>
                            <h6 class="card-subtitle mb-2 text-muted">@message</h6>
                        </div>
                    </div>
                </div>
            </div>
        }
        <div class="col-12 font-weight-light">
            <p class="text-center text-white mb-0 px-4 small">
                Copyright © <b>2023</b> All rights reserved.

                Design: Tran Duy Nguyen Nhon
            </p>
        </div>
    </footer>

    @await RenderSectionAsync("Cart", required: false)

    <script src="~/lib/jquery/dist/jquery.min.js"></script>
    <script src="~/lib/bootstrap/dist/js/bootstrap.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.3.1/dist/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
    <script src="~/js/admin/previewImage.js"></script>
    <script>
        function HideToast() {
            const toastLiveExample = document.getElementById('liveToast');
            console.log("App");
            toastLiveExample.innerHTML = '';
        }
        setTimeout(HideToast, 4000);
    </script>
    @await Html.PartialAsync("_ValidationScriptsPartial")
    @await RenderSectionAsync("Scripts", required: false)
</body>
</html>
